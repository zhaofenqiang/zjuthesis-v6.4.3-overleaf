\cleardoublepage
\chapternonum{摘\quad 要}
随着MRI技术的问世与发展，无创地采集、观察并研究人类大脑图像及相关的神经系统发育与疾病成为可能。在过去几十年中，MR图像处理的技术发展日趋成熟，最关键的便是基于脑体积的数据处理和基于脑皮层的数据处理流程（pipeline）。其中基于脑体积的分析已经开发出了很多基于深度学习的算法来提高其速度与精度，解决了很多大脑MR图像处理中的难题，然而基于脑皮层的处理与分析大多还是基于传统的手工特征加机器学习的方法，在很多应用上已经满足不了当前大规模神经影像数据处理的要求。因此在本论文中，为了获得更好、更快、更准的脑皮层数据处理结果，我们针对当前脑皮层分析pipeline中存在的问题进行改进，利用深度学习方法极大地加快了数据处理流程的同时也获得了相比当前方法高地多的准确度。具体来讲，我们的论文在使用基于卷积神经网络（Convolutional Neural Network, CNN）的深度学习方法对脑皮层数据进行处理上进行了深入的研究，重点围绕以下四个方面的工作展开。

（1）基于球面U-Net的皮层分区与属性预测。CNN近十年来为2D/3D图像的学习任务提供了最先进的性能。然而医学图像中许多结构是在manifold空间中具有球形拓扑结构的，例如，大脑皮层或皮层下表面。它们没有一致的邻域定义，因而无法对它们进行直接的卷积/转置卷积。在本论文中，通过观察并利用重新采样到球面空间的皮层表面的规则的几何结构，我们提出了一种新型的卷积滤波器——1-ring卷积核。然后我们在球面数据上开发了相应的卷积、池化和转置卷积的操作，从而构建了球面U-Net（Spherical U-Net）结构。然后，我们将球面U-Net应用于大脑皮层数据处理中两个具有挑战性的任务：皮层表面分区和皮层属性发育预测。这两个应用都证明了我们的球面U-Net与当前最好的方法相比，在准确性和计算效率上具有更加优越的性能。

（2）基于三个正交球面U-Net的快速球面配准算法。皮层表面配准将不同个体和时间点的皮层表面对齐，以建立横向和纵向的皮层对应关系。虽然目前的一些配准算法很有效，但它们要么耗时，要么无法扩展到多维或高维特征。考虑到当前大规模和多模态大脑MRI数据的应用情况，在本论文中，我们开发了一个超快球面配准（Superfast Spherical Surface Registration, S3Reg）算法。利用端到端的无监督学习策略，S3Reg在输入特征和输出相似度上提供了很大的灵活性，同时显著地降低了配准时间。为了处理极点失真问题，我们设计了三个正交球面U-Net结构，再利用球面CNN强大的学习能力直接学习球面空间中的速度场，并通过“缩放和平方”层得到了拓扑保证的变形场。分别配准了成人和婴儿的多模态皮层特征的实验结果表明，我们的S3Reg获得了与当前最好方法相当的性能，但同时将配准时间从1分钟降低到了10秒。	

（3）基于球面神经网络的大脑皮层同时分区与配准。传统的大脑皮层配准与分区是两个独立的任务，这忽略了他们之间的密切联系。本质上这两个任务都依赖有意义的皮层特征学习，因此可以共享它们学习的特征来对它们进行同时优化。为此，我们提出了一个同时进行配准和分区的深层球面神经网络。我们的方法首先利用一个编码器学习它们的共享特征，然后分别为配准和分区训练一个特定的解码器，再进一步利用它们之间明确的联系，加入了分区图相似性损失来强制要求感兴趣区域边界的一致性，从而为配准任务提供额外的监督信息。反过来，通过将一个带有人工标记的分区图配准到另一个球面上可以为分区任务提供额外的训练数据。在一个有600多个样本的数据集上的实验表明，我们的方法比单独训练的模型有着很大的提升，并且能够使用很少的标记数据来训练高质量的分区和配准模型。

（4）基于球面U-Net的多中心皮层属性数据结合方法。直接结合多中心的神经影像数据，例如大脑皮层厚度，进行联合分析将不可避免地引入MRI扫描仪的差异。为了解决这个问题，我们将球面U-Net和周期一致性对抗性网络结合起来，提出了一个基于球面皮层表面的周期一致性对抗网络——S2SGAN。首先我们将从扫描仪$X$到扫描仪$Y$的数据结合建模为球面到球面数据的映射任务。因此，我们要学习一个映射$G_X:X\rightarrow Y$，使得$G_X(X)$的数据分布与$Y$无法区分。其次，我们还要保留个体差异，于是便利用逆映射$G_Y:Y\rightarrow X$和周期一致性损失让$G_Y(G_X(X))\approx X$（反之亦然）。我们在合成的和真实的脑皮层数据上的定量和定性结果都表明，与最先进的方法相比，我们的方法在消除不必要的扫描仪效应和保留个体差异方面获得了更好的结果。



\textbf{关键词}：球面网络；神经网络；卷积神经网络；皮层分区；皮层配准；无监督学习；大脑发育模型；数据融合






\cleardoublepage
\chapternonum{Abstract}
With the advance of MRI technology, it has become possible to acquire, observe and study images of the human brain and neurological development and diseases in a non-invasive way. Over the past few decades, MR image processing pipelines have been developed and matured, in which the most critical steps are brain volume-based analysis and cortical surface-based analysis. Recently, many deep learning-based algorithms have been developed to improve the speed and accuracy of volume-based analysis, but surface-based analysis still relies on the traditional hand crafted features and machine learning algorithms, which can no longer meet the requirements of current large-scale neuroimaging studies. Therefore, in this thesis, in order to obtain better, faster, and more accurate results of surface-based analysis, we use deep learning methods to greatly speed up the pipelines and obtain more accurate results than the state-of-the-art methods. Specifically, this thesis presents an comprehensive study on the use of Convolutional Neural Network (CNN) for analyzing cortical surface data, focusing on the following four subjects.

(1) Spherical U-Net-based cortical parcellation and development prediction. CNNs have been providing the state-of-the-art performance for learning-related problems for 2D/3D images. However, many structures in medical imaging have a spherical topology in a manifold space, e.g., brain cortical or subcortical surfaces. Hence, there is no consistent neighborhood definition and thus no straightforward convolution/transposed convolution operations for these data. In this thesis, by leveraging the regular and consistent geometric structure of the resampled spherical cortical surface, we propose a novel convolution filter, called 1-ring filter. Accordingly, we develop corresponding operations for convolution, pooling, and transposed convolution for spherical surface data and thus construct spherical U-Net. We then apply Spherical U-Net to two important cortical surface analysis tasks: parcellation and development prediction. Both applications demonstrate the competitive performance in the accuracy and computational efficiency of our Spherical U-Net, in comparison with the state-of-the-art methods.
 
(2) Superfast Spherical Surface Registration (S3Reg) based on three orthogonal Spherical U-Nets. Cortical surface registration aligns cortical surfaces across individuals and time points to establish cross-sectional and longitudinal cortical correspondences to facilitate neuroimaging studies. Though achieving good performance, available methods are either time consuming or not flexible to extend to multimodal features. In this thesis, we develop the S3Reg framework by leveraging an end-to-end unsupervised learning strategy. It offers great flexibility in the choice of input feature sets and output similarity measures, and meanwhile reduces the registration time significantly. To handle the polar-distortion issue, we construct the three orthogonal Spherical U-Nets architecture to directly learn the velocity fields, and then use 6 “scaling and squaring” layers to guarantee topology-preserving deformations. Experiments are performed to align both adult and infant multimodal cortical features. Results demonstrate our S3Reg shows superior performance with state-of-the-art methods, while improving the registration time from 1 min to 10 sec.	

(3) Joint cortical surface registration and parcellation based on deep spherical neural network. Conventionally, cortical surface registration and parcellation are performed independently as two tasks, ignoring the inherent connections of them. Essentially, both tasks rely on meaningful cortical feature representations, so they can be jointly optimized to learn shared useful features. To this end, we propose a deep learning framework for joint cortical surface registration and parcellation. Our approach first uses a shared encoder to learn shared features for both tasks. Then we train two task-specific decoders for registration and parcellation, respectively. We further exploit the more explicit connection between them by incorporating the novel parcellation map similarity loss to enforce the region-of-interests' boundary consistency, thereby providing extra supervision for the registration task. Conversely, warping one surface with manual parcellation map to another surface provides a large amount of augmented data for parcellation task. Experiments on a dataset with more than 600 cortical surfaces show that our approach achieves large improvements over separately trained networks and enables training high-quality parcellation and registration models using much fewer labeled data.
 
(4)	Harmonization of cortical property data based on Spherical U-Net. A joint analysis of cortical properties (e.g., cortical thickness) of multi-site neuroimaging data is unavoidably facing the problem of differences in MRI scanners. To address this issue, in this thesis, we combine Spherical U-Net and CycleGAN to construct a surface-to-surface CycleGAN (S2SGAN) for harmonizing cortical thickness maps between different scanners. Specifically, we model the harmonization from scanner $X$ to scanner $Y$ as a surface-to-surface translation task. The first goal of harmonization is to learn a mapping $G_X: X\rightarrow Y$ such that the distribution of thickness maps from $G_X(X)$ is indistinguishable from $Y$. With the second goal of harmonization to preserve individual differences, we utilize the inverse mapping $G_Y: Y\rightarrow X$ and the cycle consistency loss to enforce $G_Y(G_X(X))\approx X$ (and vice versa). Quantitative evaluation on both synthesized and real cortical data demonstrates the superior ability of our method in removing unwanted scanner effects and preserving individual differences simultaneously, compared to the state-of-the-art methods.
 
\textbf{Keywords}: Spherical network; neural network; convolutional neural network; cortical surface parcellation; cortical surface registration; unsupervised learning; brain growth model; harmonization


